# Top Navigation Bar (Верхняя панель навигации)

## Обзор

Верхняя панель навигации — это компонент, отвечающий за навигацию по основным разделам приложения, быстрый доступ к настройкам и управление проектом. Она обеспечивает единую точку доступа к основным функциям приложения и отображает информацию о текущем состоянии проекта.

## Состояние

Верхняя панель навигации управляется через машину состояний `modalMachine`, которая контролирует:

- Открытие и закрытие модальных окон
- Навигацию между разделами
- Отображение информации о текущем состоянии

## Основные функции

- Навигация по основным разделам
- Быстрый доступ к настройкам
- Управление проектом
- Информация о текущем состоянии

## Структура компонентов

### Основные компоненты

- `layout/` - компоненты макета
  - `top-nav.tsx` - верхняя панель навигации
  - `nav-item.tsx` - элемент навигации
  - `nav-dropdown.tsx` - выпадающее меню
  - `nav-separator.tsx` - разделитель
  - `nav-group.tsx` - группа элементов

### Файлы состояния

- `machines/modal-machine.ts` - машина состояний
- `providers/modal-provider.tsx` - провайдер контекста

## Описание машины состояний

`modalMachine` управляет модальными окнами и навигацией в приложении. Она контролирует открытие/закрытие модальных окон, их содержимое и размер, а также обеспечивает навигацию между разделами приложения.

### Контекст modalMachine

- `isOpen: boolean` - состояние модального окна
- `content: ReactNode` - содержимое модального окна
- `title: string` - заголовок модального окна
- `size: 'sm' | 'md' | 'lg' | 'xl'` - размер модального окна
- `onClose: () => void` - обработчик закрытия

### Методы modalMachine

- `openModal` - открытие модального окна
- `closeModal` - закрытие модального окна
- `setContent` - установка содержимого
- `setTitle` - установка заголовка
- `setSize` - установка размера
- `setOnClose` - установка обработчика закрытия

## Элементы верхней панели

### Логотип и название проекта

- **Логотип** - иконка приложения
- **Название проекта** - текущее название проекта
- **Индикатор изменений** - показывает, есть ли несохраненные изменения

### Основное меню

- **Файл** - операции с файлами (создание, открытие, сохранение, экспорт)
- **Правка** - операции редактирования (отмена, повтор, копирование, вставка)
- **Вид** - настройки отображения (масштаб, полноэкранный режим)
- **Проект** - настройки проекта
- **Инструменты** - дополнительные инструменты
- **Помощь** - справка и информация о приложении

### Быстрые действия

- **Создать** - создание нового проекта
- **Открыть** - открытие существующего проекта
- **Сохранить** - сохранение текущего проекта
- **Экспорт** - экспорт проекта
- **Отмена** - отмена последнего действия
- **Повтор** - повтор отмененного действия

### Индикаторы состояния

- **Прогресс** - индикатор выполнения операций
- **Уведомления** - счетчик уведомлений
- **Статус проекта** - текущий статус проекта (сохранен, изменен)
- **Время последнего сохранения** - когда проект был сохранен в последний раз

## Модальные окна

### Диалог настроек проекта

- **Основные настройки** - название, разрешение, частота кадров
- **Дополнительные настройки** - цветовое пространство, аудио настройки
- **Кнопки действий** - сохранить, отменить, сбросить

### Диалог экспорта

- **Формат** - выбор формата экспорта
- **Качество** - настройки качества
- **Пресеты** - выбор пресета
- **Дополнительные параметры** - кодек, битрейт, метаданные
- **Кнопки действий** - экспорт, отмена

### Диалог о программе

- **Версия** - текущая версия приложения
- **Авторы** - информация о разработчиках
- **Лицензия** - информация о лицензии
- **Благодарности** - список используемых библиотек и ресурсов

## Взаимодействие с другими компонентами

### Взаимодействие с браузером

- Открытие диалога импорта медиафайлов
- Переключение между вкладками браузера

### Взаимодействие с таймлайном

- Открытие диалога настроек проекта
- Управление отменой/повтором действий

### Взаимодействие с плеером

- Управление воспроизведением
- Переключение в полноэкранный режим

## Примеры использования

### Открытие модального окна

```typescript
// В компоненте верхней панели
const { openModal } = useModal();

const handleOpenSettings = () => {
  openModal({
    title: 'Настройки проекта',
    content: <ProjectSettings />,
    size: 'lg',
    onClose: () => console.log('Диалог настроек закрыт'),
  });
};
```

### Создание нового проекта

```typescript
// В компоненте верхней панели
const { resetProject } = useProject();
const { openModal } = useModal();

const handleNewProject = () => {
  // Проверка на несохраненные изменения
  if (isDirty) {
    openModal({
      title: 'Несохраненные изменения',
      content: (
        <div>
          <p>У вас есть несохраненные изменения. Сохранить перед созданием нового проекта?</p>
          <div>
            <button onClick={handleSaveAndNew}>Сохранить и создать новый</button>
            <button onClick={handleDiscardAndNew}>Не сохранять и создать новый</button>
            <button onClick={handleCancel}>Отмена</button>
          </div>
        </div>
      ),
      size: 'md',
    });
  } else {
    resetProject();
  }
};
```

## Планы по развитию

- Добавление поддержки тем оформления
- Улучшение отзывчивости интерфейса
- Добавление настраиваемых панелей инструментов
- Реализация системы уведомлений
- Добавление поддержки плагинов
- Интеграция с чатом и панелью выбора ИИ-моделей для редактирования схемы видео
- Добавление панели ресурсов слева от таймлайна

## Связанные документы

- [Обзор архитектуры](../architecture/overview.md)
- [Машины состояний](../architecture/state-machines.md)
- [Руководство пользователя по интерфейсу](../user-guide/getting-started.md)
